(function(t){"use strict";var e=function(){return t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||function(e){t.setTimeout(e,1e3/60)}}();var r=t.jsmpeg=function(t,e){e=e||{};this.progressive=e.progressive!==false;this.benchmark=!!e.benchmark;this.canvas=e.canvas||document.createElement("canvas");this.autoplay=!!e.autoplay;this.wantsToPlay=this.autoplay;this.loop=!!e.loop;this.seekable=!!e.seekable;this.externalLoadCallback=e.onload||null;this.externalDecodeCallback=e.ondecodeframe||null;this.externalFinishedCallback=e.onfinished||null;this.customIntraQuantMatrix=new Uint8Array(64);this.customNonIntraQuantMatrix=new Uint8Array(64);this.blockData=new Int32Array(64);this.zeroBlockData=new Int32Array(64);this.fillArray(this.zeroBlockData,0);if(!e.forceCanvas2D&&this.initWebGL()){this.renderFrame=this.renderFrameGL}else{this.canvasContext=this.canvas.getContext("2d");this.renderFrame=this.renderFrame2D}if(t instanceof WebSocket){this.client=t;this.client.onopen=this.initSocketClient.bind(this)}else{this.load(t)}};r.prototype.waitForIntraFrame=true;r.prototype.socketBufferSize=512*1024;r.prototype.initSocketClient=function(){this.buffer=new E(new ArrayBuffer(this.socketBufferSize));this.nextPictureBuffer=new E(new ArrayBuffer(this.socketBufferSize));this.nextPictureBuffer.writePos=0;this.nextPictureBuffer.chunkBegin=0;this.nextPictureBuffer.lastWriteBeforeWrap=0;this.client.binaryType="arraybuffer";this.client.onmessage=this.receiveSocketMessage.bind(this)};r.prototype.decodeSocketHeader=function(t){if(t[0]===i.charCodeAt(0)&&t[1]===i.charCodeAt(1)&&t[2]===i.charCodeAt(2)&&t[3]===i.charCodeAt(3)){this.width=t[4]*256+t[5];this.height=t[6]*256+t[7];this.initBuffers()}};r.prototype.receiveSocketMessage=function(t){var r=new Uint8Array(t.data);if(!this.sequenceStarted){this.decodeSocketHeader(r)}var i=this.buffer;var s=this.nextPictureBuffer;if(s.writePos+r.length>s.length){s.lastWriteBeforeWrap=s.writePos;s.writePos=0;s.index=0}s.bytes.set(r,s.writePos);s.writePos+=r.length;var a=0;while(true){a=s.findNextMPEGStartCode();if(a===E.NOT_FOUND||s.index>>3>s.writePos){s.index=Math.max(s.writePos-3,0)<<3;return}else if(a===P){break}}if(this.waitForIntraFrame){s.advance(10);if(s.getBits(3)===g){this.waitForIntraFrame=false;s.chunkBegin=s.index-13>>3}return}if(!this.currentPictureDecoded){this.decodePicture(o)}var h=s.index>>3;if(h>s.chunkBegin){i.bytes.set(s.bytes.subarray(s.chunkBegin,h));i.writePos=h-s.chunkBegin}else{i.bytes.set(s.bytes.subarray(s.chunkBegin,s.lastWriteBeforeWrap));var n=s.lastWriteBeforeWrap-s.chunkBegin;i.bytes.set(s.bytes.subarray(0,h),n);i.writePos=h+n}i.index=0;s.chunkBegin=h;this.currentPictureDecoded=false;e(this.scheduleDecoding.bind(this),this.canvas)};r.prototype.scheduleDecoding=function(){this.decodePicture();this.currentPictureDecoded=true};r.prototype.isRecording=false;r.prototype.recorderWaitForIntraFrame=false;r.prototype.recordedFrames=0;r.prototype.recordedSize=0;r.prototype.didStartRecordingCallback=null;r.prototype.recordBuffers=[];r.prototype.canRecord=function(){return this.client&&this.client.readyState===this.client.OPEN};r.prototype.startRecording=function(t){if(!this.canRecord()){return}this.discardRecordBuffers();this.isRecording=true;this.recorderWaitForIntraFrame=true;this.didStartRecordingCallback=t||null;this.recordedFrames=0;this.recordedSize=0;var e=this.width>>4,r=(this.width&15)<<4|this.height>>8,i=this.height&255;this.recordBuffers.push(new Uint8Array([0,0,1,179,e,r,i,19,255,255,225,88,0,0,1,184,0,8,0,0,0,0,1,0]))};r.prototype.recordFrameFromCurrentBuffer=function(){if(!this.isRecording){return}if(this.recorderWaitForIntraFrame){if(this.pictureCodingType!==g){return}this.recorderWaitForIntraFrame=false;if(this.didStartRecordingCallback){this.didStartRecordingCallback(this)}}this.recordedFrames++;this.recordedSize+=this.buffer.writePos;this.recordBuffers.push(new Uint8Array(this.buffer.bytes.subarray(0,this.buffer.writePos)))};r.prototype.discardRecordBuffers=function(){this.recordBuffers=[];this.recordedFrames=0};r.prototype.stopRecording=function(){var t=new Blob(this.recordBuffers,{type:"video/mpeg"});this.discardRecordBuffers();this.isRecording=false;return t};r.prototype.intraFrames=[];r.prototype.currentFrame=-1;r.prototype.currentTime=0;r.prototype.frameCount=0;r.prototype.duration=0;r.prototype.progressiveMinSize=128*1024;r.prototype.fetchReaderPump=function(t){var e=this;t.read().then(function(r){e.fetchReaderReceive(t,r)})};r.prototype.fetchReaderReceive=function(t,e){if(e.done){if(this.seekable){var r=this.buffer.index;this.collectIntraFrames();this.buffer.index=r}this.duration=this.frameCount/this.pictureRate;this.lastFrameIndex=this.buffer.writePos<<3;return}this.buffer.bytes.set(e.value,this.buffer.writePos);this.buffer.writePos+=e.value.byteLength;this.lastFrameIndex=this.findLastPictureStartCode();if(!this.sequenceStarted&&this.buffer.writePos>=this.progressiveMinSize){this.findStartCode(T);this.firstSequenceHeader=this.buffer.index;this.decodeSequenceHeader();this.nextFrame();if(this.autoplay){this.play()}if(this.externalLoadCallback){this.externalLoadCallback(this)}}else if(this.sequenceStarted&&this.wantsToPlay&&!this.playing){this.play()}else if(!this.sequenceStarted){var i={loaded:this.buffer.writePos,total:this.progressiveMinSize};if(this.gl){this.updateLoaderGL(i)}else{this.updateLoader2D(i)}}this.fetchReaderPump(t)};r.prototype.findLastPictureStartCode=function(){var t=this.buffer.bytes;for(var e=this.buffer.writePos;e>3;e--){if(t[e]==P&&t[e-1]==1&&t[e-2]==0&&t[e-3]==0){return e-3<<3}}return 0};r.prototype.load=function(e){this.url=e;var r=this;if(this.progressive&&t.fetch&&t.ReadableByteStream){var i=new Headers;i.append("Content-Type","video/mpeg");fetch(e,{headers:i}).then(function(t){var e=t.headers.get("Content-Length");var i=t.body.getReader();r.buffer=new E(new ArrayBuffer(e));r.buffer.writePos=0;r.fetchReaderPump(i)})}else{var o=new XMLHttpRequest;o.onreadystatechange=function(){if(o.readyState===o.DONE&&o.status===200){r.loadCallback(o.response)}};o.onprogress=this.gl?this.updateLoaderGL.bind(this):this.updateLoader2D.bind(this);o.open("GET",e);o.responseType="arraybuffer";o.send()}};r.prototype.updateLoader2D=function(t){var e=t.loaded/t.total,r=this.canvas.width,i=this.canvas.height,o=this.canvasContext;o.fillStyle="#222";o.fillRect(0,0,r,i);o.fillStyle="#fff";o.fillRect(0,i-i*e,r,i*e)};r.prototype.updateLoaderGL=function(t){var e=this.gl;e.uniform1f(e.getUniformLocation(this.loadingProgram,"loaded"),t.loaded/t.total);e.drawArrays(e.TRIANGLE_STRIP,0,4)};r.prototype.loadCallback=function(t){this.buffer=new E(t);if(this.seekable){this.collectIntraFrames();this.buffer.index=0}this.findStartCode(T);this.firstSequenceHeader=this.buffer.index;this.decodeSequenceHeader();this.duration=this.frameCount/this.pictureRate;this.nextFrame();if(this.autoplay){this.play()}if(this.externalLoadCallback){this.externalLoadCallback(this)}};r.prototype.collectIntraFrames=function(){var t;for(t=0;this.findStartCode(P)!==E.NOT_FOUND;t++){this.buffer.advance(10);if(this.buffer.getBits(3)===g){this.intraFrames.push({frame:t,index:this.buffer.index-13})}}this.frameCount=t};r.prototype.seekToFrame=function(t,e){if(t<0||t>=this.frameCount||!this.intraFrames.length){return false}var r=null;for(var i=0;i<this.intraFrames.length&&this.intraFrames[i].frame<=t;i++){r=this.intraFrames[i]}this.buffer.index=r.index;this.currentFrame=r.frame-1;if(e){for(var s=r.frame;s<t;s++){this.decodePicture(o);this.findStartCode(P)}this.currentFrame=t-1}this.decodePicture();return true};r.prototype.seekToTime=function(t,e){this.seekToFrame(t*this.pictureRate|0,e)};r.prototype.play=function(){if(this.playing){return}this.targetTime=this.now();this.playing=true;this.wantsToPlay=true;this.scheduleNextFrame()};r.prototype.pause=function(){this.playing=false;this.wantsToPlay=false};r.prototype.stop=function(){this.currentFrame=-1;if(this.buffer){this.buffer.index=this.firstSequenceHeader}this.playing=false;if(this.client){this.client.close();this.client=null}this.wantsToPlay=false};r.prototype.readCode=function(t){var e=0;do{e=t[e+this.buffer.getBits(1)]}while(e>=0&&t[e]!==0);return t[e+2]};r.prototype.findStartCode=function(t){var e=0;while(true){e=this.buffer.findNextMPEGStartCode();if(e===t||e===E.NOT_FOUND){return e}}return E.NOT_FOUND};r.prototype.fillArray=function(t,e){for(var r=0,i=t.length;r<i;r++){t[r]=e}};r.prototype.pictureRate=30;r.prototype.lateTime=0;r.prototype.firstSequenceHeader=0;r.prototype.targetTime=0;r.prototype.benchmark=false;r.prototype.benchFrame=0;r.prototype.benchDecodeTimes=0;r.prototype.benchAvgFrameTime=0;r.prototype.now=function(){return t.performance?t.performance.now():Date.now()};r.prototype.nextFrame=function(){if(!this.buffer){return}var t=this.now();while(true){var e=this.buffer.findNextMPEGStartCode();if(e===T){this.decodeSequenceHeader()}else if(e===P){if(this.progressive&&this.buffer.index>=this.lastFrameIndex){this.playing=false;return}if(this.playing){this.scheduleNextFrame()}this.decodePicture();this.benchDecodeTimes+=this.now()-t;return this.canvas}else if(e===E.NOT_FOUND){this.stop();if(this.externalFinishedCallback){this.externalFinishedCallback(this)}if(this.loop&&this.sequenceStarted){this.play()}return null}else{}}};r.prototype.scheduleNextFrame=function(){this.lateTime=this.now()-this.targetTime;var e=Math.max(0,1e3/this.pictureRate-this.lateTime);this.targetTime=this.now()+e;if(this.benchmark){this.benchFrame++;if(this.benchFrame>=120){this.benchAvgFrameTime=this.benchDecodeTimes/this.benchFrame;this.benchFrame=0;this.benchDecodeTimes=0;if(t.console){console.log("Average time per frame:",this.benchAvgFrameTime,"ms")}}setTimeout(this.nextFrame.bind(this),0)}else if(e<18){this.scheduleAnimation()}else{setTimeout(this.scheduleAnimation.bind(this),e)}};r.prototype.scheduleAnimation=function(){e(this.nextFrame.bind(this),this.canvas)};r.prototype.decodeSequenceHeader=function(){this.width=this.buffer.getBits(12);this.height=this.buffer.getBits(12);this.buffer.advance(4);this.pictureRate=s[this.buffer.getBits(4)];this.buffer.advance(18+1+10+1);this.initBuffers();var t;if(this.buffer.getBits(1)){for(t=0;t<64;t++){this.customIntraQuantMatrix[a[t]]=this.buffer.getBits(8)}this.intraQuantMatrix=this.customIntraQuantMatrix}if(this.buffer.getBits(1)){for(t=0;t<64;t++){this.customNonIntraQuantMatrix[a[t]]=this.buffer.getBits(8)}this.nonIntraQuantMatrix=this.customNonIntraQuantMatrix}};r.prototype.initBuffers=function(){this.intraQuantMatrix=h;this.nonIntraQuantMatrix=n;this.mbWidth=this.width+15>>4;this.mbHeight=this.height+15>>4;this.mbSize=this.mbWidth*this.mbHeight;this.codedWidth=this.mbWidth<<4;this.codedHeight=this.mbHeight<<4;this.codedSize=this.codedWidth*this.codedHeight;this.halfWidth=this.mbWidth<<3;this.halfHeight=this.mbHeight<<3;this.quarterSize=this.codedSize>>2;if(this.sequenceStarted){return}this.sequenceStarted=true;var e=t.Uint8ClampedArray||t.Uint8Array;if(!t.Uint8ClampedArray){this.copyBlockToDestination=this.copyBlockToDestinationClamp;this.addBlockToDestination=this.addBlockToDestinationClamp}this.currentY=new e(this.codedSize);this.currentY32=new Uint32Array(this.currentY.buffer);this.currentCr=new e(this.codedSize>>2);this.currentCr32=new Uint32Array(this.currentCr.buffer);this.currentCb=new e(this.codedSize>>2);this.currentCb32=new Uint32Array(this.currentCb.buffer);this.forwardY=new e(this.codedSize);this.forwardY32=new Uint32Array(this.forwardY.buffer);this.forwardCr=new e(this.codedSize>>2);this.forwardCr32=new Uint32Array(this.forwardCr.buffer);this.forwardCb=new e(this.codedSize>>2);this.forwardCb32=new Uint32Array(this.forwardCb.buffer);this.canvas.width=this.width;this.canvas.height=this.height;if(this.gl){this.gl.useProgram(this.program);this.gl.viewport(0,0,this.width,this.height)}else{this.currentRGBA=this.canvasContext.getImageData(0,0,this.width,this.height);this.fillArray(this.currentRGBA.data,255)}};r.prototype.currentY=null;r.prototype.currentCr=null;r.prototype.currentCb=null;r.prototype.currentRGBA=null;r.prototype.pictureCodingType=0;r.prototype.forwardY=null;r.prototype.forwardCr=null;r.prototype.forwardCb=null;r.prototype.fullPelForward=false;r.prototype.forwardFCode=0;r.prototype.forwardRSize=0;r.prototype.forwardF=0;r.prototype.decodePicture=function(t){this.currentFrame++;this.currentTime=this.currentFrame/this.pictureRate;this.buffer.advance(10);this.pictureCodingType=this.buffer.getBits(3);this.buffer.advance(16);if(this.pictureCodingType<=0||this.pictureCodingType>=C){return}if(this.pictureCodingType===v){this.fullPelForward=this.buffer.getBits(1);this.forwardFCode=this.buffer.getBits(3);if(this.forwardFCode===0){return}this.forwardRSize=this.forwardFCode-1;this.forwardF=1<<this.forwardRSize}var e=0;do{e=this.buffer.findNextMPEGStartCode()}while(e===k||e===A);while(e>=F&&e<=x){this.decodeSlice(e&255);e=this.buffer.findNextMPEGStartCode()}this.buffer.rewind(32);this.recordFrameFromCurrentBuffer();if(t!==o){this.renderFrame();if(this.externalDecodeCallback){this.externalDecodeCallback(this,this.canvas)}}if(this.pictureCodingType===g||this.pictureCodingType===v){var r=this.forwardY,i=this.forwardY32,s=this.forwardCr,a=this.forwardCr32,h=this.forwardCb,n=this.forwardCb32;this.forwardY=this.currentY;this.forwardY32=this.currentY32;this.forwardCr=this.currentCr;this.forwardCr32=this.currentCr32;this.forwardCb=this.currentCb;this.forwardCb32=this.currentCb32;this.currentY=r;this.currentY32=i;this.currentCr=s;this.currentCr32=a;this.currentCb=h;this.currentCb32=n}};r.prototype.YCbCrToRGBA=function(){var t=this.currentY;var e=this.currentCb;var r=this.currentCr;var i=this.currentRGBA.data;var o=0;var s=this.codedWidth;var a=this.codedWidth+(this.codedWidth-this.width);var h=0;var n=this.halfWidth-(this.width>>1);var c=0;var d=this.width*4;var f=this.width*4;var u=this.width>>1;var l=this.height>>1;var p,b,m,y,w;for(var g=0;g<l;g++){for(var v=0;v<u;v++){p=e[h];b=r[h];h++;m=b+(b*103>>8)-179;y=(p*88>>8)-44+(b*183>>8)-91;w=p+(p*198>>8)-227;var C=t[o++];var T=t[o++];i[c]=C+m;i[c+1]=C-y;i[c+2]=C+w;i[c+4]=T+m;i[c+5]=T-y;i[c+6]=T+w;c+=8;var F=t[s++];var x=t[s++];i[d]=F+m;i[d+1]=F-y;i[d+2]=F+w;i[d+4]=x+m;i[d+5]=x-y;i[d+6]=x+w;d+=8}o+=a;s+=a;c+=f;d+=f;h+=n}};r.prototype.renderFrame2D=function(){this.YCbCrToRGBA();this.canvasContext.putImageData(this.currentRGBA,0,0)};r.prototype.gl=null;r.prototype.program=null;r.prototype.YTexture=null;r.prototype.CBTexture=null;r.prototype.CRTexture=null;r.prototype.createTexture=function(t,e){var r=this.gl;var i=r.createTexture();r.bindTexture(r.TEXTURE_2D,i);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE);r.uniform1i(r.getUniformLocation(this.program,e),t);return i};r.prototype.compileShader=function(t,e){var r=this.gl;var i=r.createShader(t);r.shaderSource(i,e);r.compileShader(i);if(!r.getShaderParameter(i,r.COMPILE_STATUS)){throw new Error(r.getShaderInfoLog(i))}return i};r.prototype.initWebGL=function(){var t;try{t=this.gl=this.canvas.getContext("webgl")||this.canvas.getContext("experimental-webgl")}catch(t){return false}if(!t){return false}this.buffer=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,this.buffer);t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),t.STATIC_DRAW);this.program=t.createProgram();t.attachShader(this.program,this.compileShader(t.VERTEX_SHADER,S));t.attachShader(this.program,this.compileShader(t.FRAGMENT_SHADER,B));t.linkProgram(this.program);if(!t.getProgramParameter(this.program,t.LINK_STATUS)){throw new Error(t.getProgramInfoLog(this.program))}t.useProgram(this.program);this.YTexture=this.createTexture(0,"YTexture");this.CBTexture=this.createTexture(1,"CBTexture");this.CRTexture=this.createTexture(2,"CRTexture");var e=t.getAttribLocation(this.program,"vertex");t.enableVertexAttribArray(e);t.vertexAttribPointer(e,2,t.FLOAT,false,0,0);this.loadingProgram=t.createProgram();t.attachShader(this.loadingProgram,this.compileShader(t.VERTEX_SHADER,S));t.attachShader(this.loadingProgram,this.compileShader(t.FRAGMENT_SHADER,R));t.linkProgram(this.loadingProgram);t.useProgram(this.loadingProgram);e=t.getAttribLocation(this.loadingProgram,"vertex");t.enableVertexAttribArray(e);t.vertexAttribPointer(e,2,t.FLOAT,false,0,0);return true};r.prototype.renderFrameGL=function(){var t=this.gl;var e=new Uint8Array(this.currentY.buffer),r=new Uint8Array(this.currentCr.buffer),i=new Uint8Array(this.currentCb.buffer);t.activeTexture(t.TEXTURE0);t.bindTexture(t.TEXTURE_2D,this.YTexture);t.texImage2D(t.TEXTURE_2D,0,t.LUMINANCE,this.codedWidth,this.height,0,t.LUMINANCE,t.UNSIGNED_BYTE,e);t.activeTexture(t.TEXTURE1);t.bindTexture(t.TEXTURE_2D,this.CBTexture);t.texImage2D(t.TEXTURE_2D,0,t.LUMINANCE,this.halfWidth,this.height/2,0,t.LUMINANCE,t.UNSIGNED_BYTE,r);t.activeTexture(t.TEXTURE2);t.bindTexture(t.TEXTURE_2D,this.CRTexture);t.texImage2D(t.TEXTURE_2D,0,t.LUMINANCE,this.halfWidth,this.height/2,0,t.LUMINANCE,t.UNSIGNED_BYTE,i);t.drawArrays(t.TRIANGLE_STRIP,0,4)};r.prototype.quantizerScale=0;r.prototype.sliceBegin=false;r.prototype.decodeSlice=function(t){this.sliceBegin=true;this.macroblockAddress=(t-1)*this.mbWidth-1;this.motionFwH=this.motionFwHPrev=0;this.motionFwV=this.motionFwVPrev=0;this.dcPredictorY=128;this.dcPredictorCr=128;this.dcPredictorCb=128;this.quantizerScale=this.buffer.getBits(5);while(this.buffer.getBits(1)){this.buffer.advance(8)}do{this.decodeMacroblock()}while(!this.buffer.nextBytesAreStartCode())};r.prototype.macroblockAddress=0;r.prototype.mbRow=0;r.prototype.mbCol=0;r.prototype.macroblockType=0;r.prototype.macroblockIntra=false;r.prototype.macroblockMotFw=false;r.prototype.motionFwH=0;r.prototype.motionFwV=0;r.prototype.motionFwHPrev=0;r.prototype.motionFwVPrev=0;r.prototype.decodeMacroblock=function(){var t=0,e=this.readCode(d);while(e===34){e=this.readCode(d)}while(e===35){t+=33;e=this.readCode(d)}t+=e;if(this.sliceBegin){this.sliceBegin=false;this.macroblockAddress+=t}else{if(this.macroblockAddress+t>=this.mbSize){return}if(t>1){this.dcPredictorY=128;this.dcPredictorCr=128;this.dcPredictorCb=128;if(this.pictureCodingType===v){this.motionFwH=this.motionFwHPrev=0;this.motionFwV=this.motionFwVPrev=0}}while(t>1){this.macroblockAddress++;this.mbRow=this.macroblockAddress/this.mbWidth|0;this.mbCol=this.macroblockAddress%this.mbWidth;this.copyMacroblock(this.motionFwH,this.motionFwV,this.forwardY,this.forwardCr,this.forwardCb);t--}this.macroblockAddress++}this.mbRow=this.macroblockAddress/this.mbWidth|0;this.mbCol=this.macroblockAddress%this.mbWidth;this.macroblockType=this.readCode(D[this.pictureCodingType]);this.macroblockIntra=this.macroblockType&1;this.macroblockMotFw=this.macroblockType&8;if((this.macroblockType&16)!==0){this.quantizerScale=this.buffer.getBits(5)}if(this.macroblockIntra){this.motionFwH=this.motionFwHPrev=0;this.motionFwV=this.motionFwVPrev=0}else{this.dcPredictorY=128;this.dcPredictorCr=128;this.dcPredictorCb=128;this.decodeMotionVectors();this.copyMacroblock(this.motionFwH,this.motionFwV,this.forwardY,this.forwardCr,this.forwardCb)}var r=(this.macroblockType&2)!==0?this.readCode(p):this.macroblockIntra?63:0;for(var i=0,o=32;i<6;i++){if((r&o)!==0){this.decodeBlock(i)}o>>=1}};r.prototype.decodeMotionVectors=function(){var t,e,r=0;if(this.macroblockMotFw){t=this.readCode(b);if(t!==0&&this.forwardF!==1){r=this.buffer.getBits(this.forwardRSize);e=(Math.abs(t)-1<<this.forwardRSize)+r+1;if(t<0){e=-e}}else{e=t}this.motionFwHPrev+=e;if(this.motionFwHPrev>(this.forwardF<<4)-1){this.motionFwHPrev-=this.forwardF<<5}else if(this.motionFwHPrev<-this.forwardF<<4){this.motionFwHPrev+=this.forwardF<<5}this.motionFwH=this.motionFwHPrev;if(this.fullPelForward){this.motionFwH<<=1}t=this.readCode(b);if(t!==0&&this.forwardF!==1){r=this.buffer.getBits(this.forwardRSize);e=(Math.abs(t)-1<<this.forwardRSize)+r+1;if(t<0){e=-e}}else{e=t}this.motionFwVPrev+=e;if(this.motionFwVPrev>(this.forwardF<<4)-1){this.motionFwVPrev-=this.forwardF<<5}else if(this.motionFwVPrev<-this.forwardF<<4){this.motionFwVPrev+=this.forwardF<<5}this.motionFwV=this.motionFwVPrev;if(this.fullPelForward){this.motionFwV<<=1}}else if(this.pictureCodingType===v){this.motionFwH=this.motionFwHPrev=0;this.motionFwV=this.motionFwVPrev=0}};r.prototype.copyMacroblock=function(t,e,r,i,o){var s,a,h,n,c,d,f,u,l;var p=this.currentY32;var b=this.currentCb32;var m=this.currentCr32;s=this.codedWidth;a=s-16;h=t>>1;n=e>>1;c=(t&1)===1;d=(e&1)===1;f=((this.mbRow<<4)+n)*s+(this.mbCol<<4)+h;u=this.mbRow*s+this.mbCol<<2;l=u+(s<<2);var y;var w,g,v;if(c){if(d){while(u<l){w=r[f]+r[f+s];f++;for(y=0;y<4;y++){g=r[f]+r[f+s];f++;v=w+g+2>>2&255;w=r[f]+r[f+s];f++;v|=w+g+2<<6&65280;g=r[f]+r[f+s];f++;v|=w+g+2<<14&16711680;w=r[f]+r[f+s];f++;v|=w+g+2<<22&4278190080;p[u++]=v}u+=a>>2;f+=a-1}}else{while(u<l){w=r[f++];for(y=0;y<4;y++){g=r[f++];v=w+g+1>>1&255;w=r[f++];v|=w+g+1<<7&65280;g=r[f++];v|=w+g+1<<15&16711680;w=r[f++];v|=w+g+1<<23&4278190080;p[u++]=v}u+=a>>2;f+=a-1}}}else{if(d){while(u<l){for(y=0;y<4;y++){v=r[f]+r[f+s]+1>>1&255;f++;v|=r[f]+r[f+s]+1<<7&65280;f++;v|=r[f]+r[f+s]+1<<15&16711680;f++;v|=r[f]+r[f+s]+1<<23&4278190080;f++;p[u++]=v}u+=a>>2;f+=a}}else{while(u<l){for(y=0;y<4;y++){v=r[f];f++;v|=r[f]<<8;f++;v|=r[f]<<16;f++;v|=r[f]<<24;f++;p[u++]=v}u+=a>>2;f+=a}}}s=this.halfWidth;a=s-8;h=t/2>>1;n=e/2>>1;c=(t/2&1)===1;d=(e/2&1)===1;f=((this.mbRow<<3)+n)*s+(this.mbCol<<3)+h;u=this.mbRow*s+this.mbCol<<1;l=u+(s<<1);var C,T,F;var x,P,k;if(c){if(d){while(u<l){C=i[f]+i[f+s];x=o[f]+o[f+s];f++;for(y=0;y<2;y++){T=i[f]+i[f+s];P=o[f]+o[f+s];f++;F=C+T+2>>2&255;k=x+P+2>>2&255;C=i[f]+i[f+s];x=o[f]+o[f+s];f++;F|=C+T+2<<6&65280;k|=x+P+2<<6&65280;T=i[f]+i[f+s];P=o[f]+o[f+s];f++;F|=C+T+2<<14&16711680;k|=x+P+2<<14&16711680;C=i[f]+i[f+s];x=o[f]+o[f+s];f++;F|=C+T+2<<22&4278190080;k|=x+P+2<<22&4278190080;m[u]=F;b[u]=k;u++}u+=a>>2;f+=a-1}}else{while(u<l){C=i[f];x=o[f];f++;for(y=0;y<2;y++){T=i[f];P=o[f++];F=C+T+1>>1&255;k=x+P+1>>1&255;C=i[f];x=o[f++];F|=C+T+1<<7&65280;k|=x+P+1<<7&65280;T=i[f];P=o[f++];F|=C+T+1<<15&16711680;k|=x+P+1<<15&16711680;C=i[f];x=o[f++];F|=C+T+1<<23&4278190080;k|=x+P+1<<23&4278190080;m[u]=F;b[u]=k;u++}u+=a>>2;f+=a-1}}}else{if(d){while(u<l){for(y=0;y<2;y++){F=i[f]+i[f+s]+1>>1&255;k=o[f]+o[f+s]+1>>1&255;f++;F|=i[f]+i[f+s]+1<<7&65280;k|=o[f]+o[f+s]+1<<7&65280;f++;F|=i[f]+i[f+s]+1<<15&16711680;k|=o[f]+o[f+s]+1<<15&16711680;f++;F|=i[f]+i[f+s]+1<<23&4278190080;k|=o[f]+o[f+s]+1<<23&4278190080;f++;m[u]=F;b[u]=k;u++}u+=a>>2;f+=a}}else{while(u<l){for(y=0;y<2;y++){F=i[f];k=o[f];f++;F|=i[f]<<8;k|=o[f]<<8;f++;F|=i[f]<<16;k|=o[f]<<16;f++;F|=i[f]<<24;k|=o[f]<<24;f++;m[u]=F;b[u]=k;u++}u+=a>>2;f+=a}}}};r.prototype.blockData=null;r.prototype.decodeBlock=function(t){var e=0,r;if(this.macroblockIntra){var i,o;if(t<4){i=this.dcPredictorY;o=this.readCode(m)}else{i=t===4?this.dcPredictorCr:this.dcPredictorCb;o=this.readCode(y)}if(o>0){var s=this.buffer.getBits(o);if((s&1<<o-1)!==0){this.blockData[0]=i+s}else{this.blockData[0]=i+(-1<<o|s+1)}}else{this.blockData[0]=i}if(t<4){this.dcPredictorY=this.blockData[0]}else if(t===4){this.dcPredictorCr=this.blockData[0]}else{this.dcPredictorCb=this.blockData[0]}this.blockData[0]<<=3+5;r=this.intraQuantMatrix;e=1}else{r=this.nonIntraQuantMatrix}var h=0;while(true){var n=0,d=this.readCode(w);if(d===1&&e>0&&this.buffer.getBits(1)===0){break}if(d===65535){n=this.buffer.getBits(6);h=this.buffer.getBits(8);if(h===0){h=this.buffer.getBits(8)}else if(h===128){h=this.buffer.getBits(8)-256}else if(h>128){h=h-256}}else{n=d>>8;h=d&255;if(this.buffer.getBits(1)){h=-h}}e+=n;var f=a[e];e++;h<<=1;if(!this.macroblockIntra){h+=h<0?-1:1}h=h*this.quantizerScale*r[f]>>4;if((h&1)===0){h-=h>0?1:-1}if(h>2047){h=2047}else if(h<-2048){h=-2048}this.blockData[f]=h*c[f]}var u,l,p;if(t<4){u=this.currentY;p=this.codedWidth-8;l=this.mbRow*this.codedWidth+this.mbCol<<4;if((t&1)!==0){l+=8}if((t&2)!==0){l+=this.codedWidth<<3}}else{u=t===4?this.currentCb:this.currentCr;p=(this.codedWidth>>1)-8;l=(this.mbRow*this.codedWidth<<2)+(this.mbCol<<3)}if(this.macroblockIntra){if(e===1){this.copyValueToDestination(this.blockData[0]+128>>8,u,l,p);this.blockData[0]=0}else{this.IDCT();this.copyBlockToDestination(this.blockData,u,l,p);this.blockData.set(this.zeroBlockData)}}else{if(e===1){this.addValueToDestination(this.blockData[0]+128>>8,u,l,p);this.blockData[0]=0}else{this.IDCT();this.addBlockToDestination(this.blockData,u,l,p);this.blockData.set(this.zeroBlockData)}}e=0};r.prototype.copyBlockToDestination=function(t,e,r,i){for(var o=0;o<64;o+=8,r+=i+8){e[r+0]=t[o+0];e[r+1]=t[o+1];e[r+2]=t[o+2];e[r+3]=t[o+3];e[r+4]=t[o+4];e[r+5]=t[o+5];e[r+6]=t[o+6];e[r+7]=t[o+7]}};r.prototype.addBlockToDestination=function(t,e,r,i){for(var o=0;o<64;o+=8,r+=i+8){e[r+0]+=t[o+0];e[r+1]+=t[o+1];e[r+2]+=t[o+2];e[r+3]+=t[o+3];e[r+4]+=t[o+4];e[r+5]+=t[o+5];e[r+6]+=t[o+6];e[r+7]+=t[o+7]}};r.prototype.copyValueToDestination=function(t,e,r,i){for(var o=0;o<64;o+=8,r+=i+8){e[r+0]=t;e[r+1]=t;e[r+2]=t;e[r+3]=t;e[r+4]=t;e[r+5]=t;e[r+6]=t;e[r+7]=t}};r.prototype.addValueToDestination=function(t,e,r,i){for(var o=0;o<64;o+=8,r+=i+8){e[r+0]+=t;e[r+1]+=t;e[r+2]+=t;e[r+3]+=t;e[r+4]+=t;e[r+5]+=t;e[r+6]+=t;e[r+7]+=t}};r.prototype.copyBlockToDestinationClamp=function(t,e,r,i){var o=0;for(var s=0;s<8;s++){for(var a=0;a<8;a++){var h=t[o++];e[r++]=h>255?255:h<0?0:h}r+=i}};r.prototype.addBlockToDestinationClamp=function(t,e,r,i){var o=0;for(var s=0;s<8;s++){for(var a=0;a<8;a++){var h=t[o++]+e[r];e[r++]=h>255?255:h<0?0:h}r+=i}};r.prototype.IDCT=function(){var t,e,r,i,o,s,a,h,n,c,d,f,u,l,p,b,m,y,w,g=this.blockData;for(w=0;w<8;++w){t=g[4*8+w];e=g[2*8+w]+g[6*8+w];r=g[5*8+w]-g[3*8+w];s=g[1*8+w]+g[7*8+w];a=g[3*8+w]+g[5*8+w];i=g[1*8+w]-g[7*8+w];o=s+a;h=g[0*8+w];u=(i*473-r*196+128>>8)-o;n=u-((s-a)*362+128>>8);c=h-t;d=((g[2*8+w]-g[6*8+w])*362+128>>8)-e;f=h+t;l=c+d;p=f+e;b=c-d;m=f-e;y=-n-(r*473+i*196+128>>8);g[0*8+w]=o+p;g[1*8+w]=u+l;g[2*8+w]=b-n;g[3*8+w]=m-y;g[4*8+w]=m+y;g[5*8+w]=n+b;g[6*8+w]=l-u;g[7*8+w]=p-o}for(w=0;w<64;w+=8){t=g[4+w];e=g[2+w]+g[6+w];r=g[5+w]-g[3+w];s=g[1+w]+g[7+w];a=g[3+w]+g[5+w];i=g[1+w]-g[7+w];o=s+a;h=g[0+w];u=(i*473-r*196+128>>8)-o;n=u-((s-a)*362+128>>8);c=h-t;d=((g[2+w]-g[6+w])*362+128>>8)-e;f=h+t;l=c+d;p=f+e;b=c-d;m=f-e;y=-n-(r*473+i*196+128>>8);g[0+w]=o+p+128>>8;g[1+w]=u+l+128>>8;g[2+w]=b-n+128>>8;g[3+w]=m-y+128>>8;g[4+w]=m+y+128>>8;g[5+w]=n+b+128>>8;g[6+w]=l-u+128>>8;g[7+w]=p-o+128>>8}};var i="jsmp",o=1,s=[0,23.976,24,25,29.97,30,50,59.94,60,0,0,0,0,0,0,0],a=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),h=new Uint8Array([8,16,19,22,26,27,29,34,16,16,22,24,27,29,34,37,19,22,26,27,29,34,34,38,22,22,26,27,29,34,37,40,22,26,27,29,32,35,40,48,26,27,29,32,35,40,48,58,26,27,29,34,38,46,56,69,27,29,35,38,46,56,69,83]),n=new Uint8Array([16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]),c=new Uint8Array([32,44,42,38,32,25,17,9,44,62,58,52,44,35,24,12,42,58,55,49,42,33,23,12,38,52,49,44,38,30,20,10,32,44,42,38,32,25,17,9,25,35,33,30,25,20,14,7,17,24,23,20,17,14,9,5,9,12,12,10,9,7,5,2]),d=new Int16Array([1*3,2*3,0,3*3,4*3,0,0,0,1,5*3,6*3,0,7*3,8*3,0,9*3,10*3,0,11*3,12*3,0,0,0,3,0,0,2,13*3,14*3,0,15*3,16*3,0,0,0,5,0,0,4,17*3,18*3,0,19*3,20*3,0,0,0,7,0,0,6,21*3,22*3,0,23*3,24*3,0,25*3,26*3,0,27*3,28*3,0,-1,29*3,0,-1,30*3,0,31*3,32*3,0,33*3,34*3,0,35*3,36*3,0,37*3,38*3,0,0,0,9,0,0,8,39*3,40*3,0,41*3,42*3,0,43*3,44*3,0,45*3,46*3,0,0,0,15,0,0,14,0,0,13,0,0,12,0,0,11,0,0,10,47*3,-1,0,-1,48*3,0,49*3,50*3,0,51*3,52*3,0,53*3,54*3,0,55*3,56*3,0,57*3,58*3,0,59*3,60*3,0,61*3,-1,0,-1,62*3,0,63*3,64*3,0,65*3,66*3,0,67*3,68*3,0,69*3,70*3,0,71*3,72*3,0,73*3,74*3,0,0,0,21,0,0,20,0,0,19,0,0,18,0,0,17,0,0,16,0,0,35,0,0,34,0,0,33,0,0,32,0,0,31,0,0,30,0,0,29,0,0,28,0,0,27,0,0,26,0,0,25,0,0,24,0,0,23,0,0,22]),f=new Int8Array([1*3,2*3,0,-1,3*3,0,0,0,1,0,0,17]),u=new Int8Array([1*3,2*3,0,3*3,4*3,0,0,0,10,5*3,6*3,0,0,0,2,7*3,8*3,0,0,0,8,9*3,10*3,0,11*3,12*3,0,-1,13*3,0,0,0,18,0,0,26,0,0,1,0,0,17]),l=new Int8Array([1*3,2*3,0,3*3,5*3,0,4*3,6*3,0,8*3,7*3,0,0,0,12,9*3,10*3,0,0,0,14,13*3,14*3,0,12*3,11*3,0,0,0,4,0,0,6,18*3,16*3,0,15*3,17*3,0,0,0,8,0,0,10,-1,19*3,0,0,0,1,20*3,21*3,0,0,0,30,0,0,17,0,0,22,0,0,26]),p=new Int16Array([2*3,1*3,0,3*3,6*3,0,4*3,5*3,0,8*3,11*3,0,12*3,13*3,0,9*3,7*3,0,10*3,14*3,0,20*3,19*3,0,18*3,16*3,0,23*3,17*3,0,27*3,25*3,0,21*3,28*3,0,15*3,22*3,0,24*3,26*3,0,0,0,60,35*3,40*3,0,44*3,48*3,0,38*3,36*3,0,42*3,47*3,0,29*3,31*3,0,39*3,32*3,0,0,0,32,45*3,46*3,0,33*3,41*3,0,43*3,34*3,0,0,0,4,30*3,37*3,0,0,0,8,0,0,16,0,0,44,50*3,56*3,0,0,0,28,0,0,52,0,0,62,61*3,59*3,0,52*3,60*3,0,0,0,1,55*3,54*3,0,0,0,61,0,0,56,57*3,58*3,0,0,0,2,0,0,40,51*3,62*3,0,0,0,48,64*3,63*3,0,49*3,53*3,0,0,0,20,0,0,12,80*3,83*3,0,0,0,63,77*3,75*3,0,65*3,73*3,0,84*3,66*3,0,0,0,24,0,0,36,0,0,3,69*3,87*3,0,81*3,79*3,0,68*3,71*3,0,70*3,78*3,0,67*3,76*3,0,72*3,74*3,0,86*3,85*3,0,88*3,82*3,0,-1,94*3,0,95*3,97*3,0,0,0,33,0,0,9,106*3,110*3,0,102*3,116*3,0,0,0,5,0,0,10,93*3,89*3,0,0,0,6,0,0,18,0,0,17,0,0,34,113*3,119*3,0,103*3,104*3,0,90*3,92*3,0,109*3,107*3,0,117*3,118*3,0,101*3,99*3,0,98*3,96*3,0,100*3,91*3,0,114*3,115*3,0,105*3,108*3,0,112*3,111*3,0,121*3,125*3,0,0,0,41,0,0,14,0,0,21,124*3,122*3,0,120*3,123*3,0,0,0,11,0,0,19,0,0,7,0,0,35,0,0,13,0,0,50,0,0,49,0,0,58,0,0,37,0,0,25,0,0,45,0,0,57,0,0,26,0,0,29,0,0,38,0,0,53,0,0,23,0,0,43,0,0,46,0,0,42,0,0,22,0,0,54,0,0,51,0,0,15,0,0,30,0,0,39,0,0,47,0,0,55,0,0,27,0,0,59,0,0,31]),b=new Int16Array([1*3,2*3,0,4*3,3*3,0,0,0,0,6*3,5*3,0,8*3,7*3,0,0,0,-1,0,0,1,9*3,10*3,0,12*3,11*3,0,0,0,2,0,0,-2,14*3,15*3,0,16*3,13*3,0,20*3,18*3,0,0,0,3,0,0,-3,17*3,19*3,0,-1,23*3,0,27*3,25*3,0,26*3,21*3,0,24*3,22*3,0,32*3,28*3,0,29*3,31*3,0,-1,33*3,0,36*3,35*3,0,0,0,-4,30*3,34*3,0,0,0,4,0,0,-7,0,0,5,37*3,41*3,0,0,0,-5,0,0,7,38*3,40*3,0,42*3,39*3,0,0,0,-6,0,0,6,51*3,54*3,0,50*3,49*3,0,45*3,46*3,0,52*3,47*3,0,43*3,53*3,0,44*3,48*3,0,0,0,10,0,0,9,0,0,8,0,0,-8,57*3,66*3,0,0,0,-9,60*3,64*3,0,56*3,61*3,0,55*3,62*3,0,58*3,63*3,0,0,0,-10,59*3,65*3,0,0,0,12,0,0,16,0,0,13,0,0,14,0,0,11,0,0,15,0,0,-16,0,0,-12,0,0,-14,0,0,-15,0,0,-11,0,0,-13]),m=new Int8Array([2*3,1*3,0,6*3,5*3,0,3*3,4*3,0,0,0,1,0,0,2,9*3,8*3,0,7*3,10*3,0,0,0,0,12*3,11*3,0,0,0,4,0,0,3,13*3,14*3,0,0,0,5,0,0,6,16*3,15*3,0,17*3,-1,0,0,0,7,0,0,8]),y=new Int8Array([2*3,1*3,0,4*3,3*3,0,6*3,5*3,0,8*3,7*3,0,0,0,2,0,0,1,0,0,0,10*3,9*3,0,0,0,3,12*3,11*3,0,0,0,4,14*3,13*3,0,0,0,5,16*3,15*3,0,0,0,6,17*3,-1,0,0,0,7,0,0,8]),w=new Int32Array([1*3,2*3,0,4*3,3*3,0,0,0,1,7*3,8*3,0,6*3,5*3,0,13*3,9*3,0,11*3,10*3,0,14*3,12*3,0,0,0,257,20*3,22*3,0,18*3,21*3,0,16*3,19*3,0,0,0,513,17*3,15*3,0,0,0,2,0,0,3,27*3,25*3,0,29*3,31*3,0,24*3,26*3,0,32*3,30*3,0,0,0,1025,23*3,28*3,0,0,0,769,0,0,258,0,0,1793,0,0,65535,0,0,1537,37*3,36*3,0,0,0,1281,35*3,34*3,0,39*3,38*3,0,33*3,42*3,0,40*3,41*3,0,52*3,50*3,0,54*3,53*3,0,48*3,49*3,0,43*3,45*3,0,46*3,44*3,0,0,0,2049,0,0,4,0,0,514,0,0,2305,51*3,47*3,0,55*3,57*3,0,60*3,56*3,0,59*3,58*3,0,61*3,62*3,0,0,0,2561,0,0,3329,0,0,6,0,0,259,0,0,5,0,0,770,0,0,2817,0,0,3073,76*3,75*3,0,67*3,70*3,0,73*3,71*3,0,78*3,74*3,0,72*3,77*3,0,69*3,64*3,0,68*3,63*3,0,66*3,65*3,0,81*3,87*3,0,91*3,80*3,0,82*3,79*3,0,83*3,86*3,0,93*3,92*3,0,84*3,85*3,0,90*3,94*3,0,88*3,89*3,0,0,0,515,0,0,260,0,0,7,0,0,1026,0,0,1282,0,0,4097,0,0,3841,0,0,3585,105*3,107*3,0,111*3,114*3,0,104*3,97*3,0,125*3,119*3,0,96*3,98*3,0,-1,123*3,0,95*3,101*3,0,106*3,121*3,0,99*3,102*3,0,113*3,103*3,0,112*3,116*3,0,110*3,100*3,0,124*3,115*3,0,117*3,122*3,0,109*3,118*3,0,120*3,108*3,0,127*3,136*3,0,139*3,140*3,0,130*3,126*3,0,145*3,146*3,0,128*3,129*3,0,0,0,2050,132*3,134*3,0,155*3,154*3,0,0,0,8,137*3,133*3,0,143*3,144*3,0,151*3,138*3,0,142*3,141*3,0,0,0,10,0,0,9,0,0,11,0,0,5377,0,0,1538,0,0,771,0,0,5121,0,0,1794,0,0,4353,0,0,4609,0,0,4865,148*3,152*3,0,0,0,1027,153*3,150*3,0,0,0,261,131*3,135*3,0,0,0,516,149*3,147*3,0,172*3,173*3,0,162*3,158*3,0,170*3,161*3,0,168*3,166*3,0,157*3,179*3,0,169*3,167*3,0,174*3,171*3,0,178*3,177*3,0,156*3,159*3,0,164*3,165*3,0,183*3,182*3,0,175*3,176*3,0,0,0,263,0,0,2562,0,0,2306,0,0,5633,0,0,5889,0,0,6401,0,0,6145,0,0,1283,0,0,772,0,0,13,0,0,12,0,0,14,0,0,15,0,0,517,0,0,6657,0,0,262,180*3,181*3,0,160*3,163*3,0,196*3,199*3,0,0,0,27,203*3,185*3,0,202*3,201*3,0,0,0,19,0,0,22,197*3,207*3,0,0,0,18,191*3,192*3,0,188*3,190*3,0,0,0,20,184*3,194*3,0,0,0,21,186*3,193*3,0,0,0,23,204*3,198*3,0,0,0,25,0,0,24,200*3,205*3,0,0,0,31,0,0,30,0,0,28,0,0,29,0,0,26,0,0,17,0,0,16,189*3,206*3,0,187*3,195*3,0,218*3,211*3,0,0,0,37,215*3,216*3,0,0,0,36,210*3,212*3,0,0,0,34,213*3,209*3,0,221*3,222*3,0,219*3,208*3,0,217*3,214*3,0,223*3,220*3,0,0,0,35,0,0,267,0,0,40,0,0,268,0,0,266,0,0,32,0,0,264,0,0,265,0,0,38,0,0,269,0,0,270,0,0,33,0,0,39,0,0,7937,0,0,6913,0,0,7681,0,0,4098,0,0,7425,0,0,7169,0,0,271,0,0,274,0,0,273,0,0,272,0,0,1539,0,0,2818,0,0,3586,0,0,3330,0,0,3074,0,0,3842]),g=1,v=2,C=3,T=179,F=1,x=175,P=0,k=181,A=178,B=["precision mediump float;","uniform sampler2D YTexture;","uniform sampler2D CBTexture;","uniform sampler2D CRTexture;","varying vec2 texCoord;","void main() {","float y = texture2D(YTexture, texCoord).r;","float cr = texture2D(CBTexture, texCoord).r - 0.5;","float cb = texture2D(CRTexture, texCoord).r - 0.5;","gl_FragColor = vec4(","y + 1.4 * cr,","y + -0.343 * cb - 0.711 * cr,","y + 1.765 * cb,","1.0",");","}"].join("\n"),R=["precision mediump float;","uniform float loaded;","varying vec2 texCoord;","void main() {","float c = ceil(loaded-(1.0-texCoord.y));","gl_FragColor = vec4(c,c,c,1);","}"].join("\n"),S=["attribute vec2 vertex;","varying vec2 texCoord;","void main() {","texCoord = vertex;","gl_Position = vec4((vertex * 2.0 - 1.0) * vec2(1, -1), 0.0, 1.0);","}"].join("\n");
var D=[null,f,u,l];var E=function(t){this.bytes=new Uint8Array(t);this.length=this.bytes.length;this.writePos=this.bytes.length;this.index=0};E.NOT_FOUND=-1;E.prototype.findNextMPEGStartCode=function(){for(var t=this.index+7>>3;t<this.writePos;t++){if(this.bytes[t]===0&&this.bytes[t+1]===0&&this.bytes[t+2]===1){this.index=t+4<<3;return this.bytes[t+3]}}this.index=this.writePos<<3;return E.NOT_FOUND};E.prototype.nextBytesAreStartCode=function(){var t=this.index+7>>3;return t>=this.writePos||this.bytes[t]===0&&this.bytes[t+1]===0&&this.bytes[t+2]===1};E.prototype.nextBits=function(t){var e=this.index>>3,r=8-this.index%8;if(r>=t){return this.bytes[e]>>r-t&255>>8-t}var i=(this.index+t)%8,o=this.index+t-1>>3,s=this.bytes[e]&255>>8-r;for(e++;e<o;e++){s<<=8;s|=this.bytes[e]}if(i>0){s<<=i;s|=this.bytes[e]>>8-i}else{s<<=8;s|=this.bytes[e]}return s};E.prototype.getBits=function(t){var e=this.nextBits(t);this.index+=t;return e};E.prototype.advance=function(t){return this.index+=t};E.prototype.rewind=function(t){return this.index-=t}})(window);